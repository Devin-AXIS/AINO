import type { ModuleModel, FieldModel } from "../store"
import type { FieldCategoryModel } from "../field-categories"
import { DEFAULT_FIELD_CATEGORIES } from "../field-categories"

const uid = () => Math.random().toString(36).slice(2, 10)

function f(
  key: string,
  label: string,
  type: any,
  required = false,
  locked = false,
  extra: Partial<FieldModel> = {},
): FieldModel {
  return {
    id: uid(),
    key,
    label,
    type,
    required,
    locked,
    enabled: true,
    showInList: true,
    showInForm: true,
    showInDetail: true,
    ...extra,
  }
}

export function createUserModule(): ModuleModel {
  return {
    id: uid(),
    name: "ç”¨æˆ·ç®¡ç†",
    type: "system",
    directories: [
      // ç”¨æˆ·ç®¡ç†
      {
        id: uid(),
        name: "ç”¨æˆ·åˆ—è¡¨",
        type: "table",
        supportsCategory: false,
        fields: [
          // åŸºç¡€å­—æ®µ
          f("id", "ç”¨æˆ·ID", "text", true, true, {
            unique: true,
            locked: true,
          }),
          f("avatar", "å¤´åƒ", "image", false, false, {
            accept: "image/*",
            maxSizeMB: 5,
          }),
          f("name", "å§“å", "text", true, false, {
            placeholder: "è¯·è¾“å…¥å§“å",
            category: "basic",
          }),
          f("phone", "æ‰‹æœºå·", "text", false, false, {
            preset: "phone",
            placeholder: "è¯·è¾“å…¥æ‰‹æœºå·",
            category: "basic",
          }),
          f("email", "é‚®ç®±", "text", false, false, {
            preset: "email",
            placeholder: "è¯·è¾“å…¥é‚®ç®±",
            category: "basic",
          }),
          f("gender", "æ€§åˆ«", "select", false, false, {
            options: ["ç”·", "å¥³", "å…¶ä»–"],
            default: "ç”·",
            category: "basic",
          }),
          f("city", "å±…ä½åŸå¸‚", "text", false, false, {
            preset: "city",
            category: "basic",
          }),
          f("birthday", "ç”Ÿæ—¥", "date", false, false, {
            dateMode: "single",
            category: "basic",
          }),

          // ç‰¹æ®Šå­—æ®µ
          f("qrcode", "äºŒç»´ç ", "barcode", false, false, {
            placeholder: "æ‰«ç æ·»åŠ ",
            category: "special",
          }),
          f("introduction", "ä¸ªäººä»‹ç»", "textarea", false, false, {
            placeholder: "è¯·è¾“å…¥ä¸ªäººä»‹ç»",
            category: "special",
          }),
          f("signature", "ä¸ªæ€§ç­¾å", "text", false, false, {
            placeholder: "è¯·è¾“å…¥ä¸ªæ€§ç­¾å",
            category: "special",
          }),
          f("title", "èŒç§°", "text", false, false, {
            placeholder: "è¯·è¾“å…¥èŒç§°",
            category: "special",
          }),
          f("hobbies", "å…´è¶£çˆ±å¥½", "tags", false, false, {
            placeholder: "æ·»åŠ å…´è¶£çˆ±å¥½æ ‡ç­¾",
            category: "special",
          }),
          f("maritalStatus", "å©šå§»çŠ¶å†µ", "select", false, false, {
            options: ["æœªå©š", "å·²å©š", "ç¦»å¼‚", "ä¸§å¶"],
            default: "æœªå©š",
            category: "special",
          }),

          // ç»å†å­—æ®µ
          f("workExperience", "å·¥ä½œç»å†", "experience", false, false, {
            desc: "å·¥ä½œç»å†ç®¡ç†",
            category: "experience",
          }),
          f("education", "æ•™è‚²ç»å†", "experience", false, false, {
            desc: "æ•™è‚²ç»å†ç®¡ç†",
            category: "experience",
          }),
          f("certificates", "è£èª‰è¯ä¹¦", "experience", false, false, {
            desc: "è¯ä¹¦å’Œè£èª‰ç®¡ç†",
            category: "experience",
          }),

          // ä¸šåŠ¡å­—æ®µ
          f("constellation", "æ˜Ÿåº§", "text", false, false, {
            preset: "constellation",
            placeholder: "è¯·é€‰æ‹©æ˜Ÿåº§",
            category: "business",
          }),
          f("skills", "æŠ€èƒ½", "text", false, false, {
            preset: "skills",
            placeholder: "è¯·é€‰æ‹©æŠ€èƒ½",
            category: "business",
          }),
          f("growthPoints", "æˆé•¿å€¼", "number", false, false, {
            min: 0,
            default: 0,
            unit: "åˆ†",
            category: "business",
          }),
          f("credits", "ç§¯åˆ†", "number", false, false, {
            min: 0,
            default: 0,
            unit: "åˆ†",
            category: "business",
          }),
          f("userLevel", "ç”¨æˆ·ç­‰çº§", "select", false, false, {
            options: ["é’é“œ", "ç™½é“¶", "é»„é‡‘", "é“‚é‡‘", "é’»çŸ³"],
            default: "é’é“œ",
            category: "business",
          }),
          f("membershipType", "ä¼šå‘˜ç±»å‹", "select", false, false, {
            options: ["æ™®é€šç”¨æˆ·", "VIPä¼šå‘˜", "SVIPä¼šå‘˜", "ä¼ä¸šä¼šå‘˜"],
            default: "æ™®é€šç”¨æˆ·",
            category: "business",
          }),
          f("membershipExpiry", "ä¼šå‘˜åˆ°æœŸæ—¶é—´", "date", false, false, {
            dateMode: "single",
            category: "business",
          }),

          // ç³»ç»Ÿå­—æ®µ
          f("status", "çŠ¶æ€", "select", true, false, {
            options: ["å¯ç”¨", "ç¦ç”¨"],
            default: "å¯ç”¨",
            category: "basic",
          }),
          f("createdAt", "åˆ›å»ºæ—¶é—´", "date", false, true, {
            locked: true,
            category: "basic",
          }),
          f("lastLoginAt", "æœ€åç™»å½•", "date", false, true, {
            locked: true,
            category: "basic",
          }),
        ],
        records: [
          {
            id: "user_1",
            name: "å¼ ä¸‰",
            phone: "13800138001",
            email: "zhangsan@example.com",
            gender: "ç”·",
            constellation: "constellation_7", // å¤©ç§¤åº§
            skills: ["skill_1", "skill_2", "skill_13"], // Vue, React, é¡¹ç›®ç®¡ç†
            introduction: "èµ„æ·±å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆï¼Œä¸“æ³¨äºVue.jså’ŒReactæŠ€æœ¯æ ˆ",
            signature: "ä»£ç æ”¹å˜ä¸–ç•Œ",
            title: "é«˜çº§å‰ç«¯å·¥ç¨‹å¸ˆ",
            birthday: "1990-10-15",
            hobbies: ["ç¼–ç¨‹", "é˜…è¯»", "æ—…è¡Œ"],
            city: "åŒ—äº¬å¸‚",
            maritalStatus: "å·²å©š",
            workExperience: [],
            education: [],
            certificates: [],
            growthPoints: 1250,
            credits: 3500,
            userLevel: "é»„é‡‘",
            membershipType: "VIPä¼šå‘˜",
            status: "å¯ç”¨",
            avatar: "/wise-wizard-library.png",
          },
          {
            id: "user_2",
            name: "æå››",
            phone: "13900139002",
            email: "lisi@example.com",
            gender: "å¥³",
            constellation: "constellation_12", // åŒé±¼åº§
            skills: ["skill_7", "skill_8"], // UIè®¾è®¡, UXè®¾è®¡
            introduction: "UI/UXè®¾è®¡å¸ˆï¼Œçƒ­çˆ±åˆ›æ„è®¾è®¡",
            signature: "è®¾è®¡è®©ç”Ÿæ´»æ›´ç¾å¥½",
            title: "èµ„æ·±è®¾è®¡å¸ˆ",
            birthday: "1992-03-20",
            hobbies: ["è®¾è®¡", "æ‘„å½±", "éŸ³ä¹"],
            city: "ä¸Šæµ·å¸‚",
            maritalStatus: "æœªå©š",
            workExperience: [],
            education: [],
            certificates: [],
            growthPoints: 980,
            credits: 2100,
            userLevel: "ç™½é“¶",
            membershipType: "æ™®é€šç”¨æˆ·",
            status: "å¯ç”¨",
            avatar: "/female-adventurer-backpack.png",
          },
          {
            id: "user_3",
            name: "ç‹äº”",
            phone: "13700137003",
            email: "wangwu@example.com",
            gender: "ç”·",
            constellation: "constellation_5", // ç‹®å­åº§
            skills: ["skill_13", "skill_14"], // é¡¹ç›®ç®¡ç†, å›¢é˜Ÿç®¡ç†
            introduction: "äº§å“ç»ç†ï¼Œä¸“æ³¨ç”¨æˆ·ä½“éªŒä¼˜åŒ–",
            signature: "ç”¨æˆ·è‡³ä¸Šï¼Œä½“éªŒä¸ºç‹",
            title: "äº§å“æ€»ç›‘",
            birthday: "1988-08-08",
            hobbies: ["äº§å“", "è¿åŠ¨", "ç”µå½±"],
            city: "æ·±åœ³å¸‚",
            maritalStatus: "å·²å©š",
            workExperience: [],
            education: [],
            certificates: [],
            growthPoints: 1800,
            credits: 5200,
            userLevel: "é’»çŸ³",
            membershipType: "SVIPä¼šå‘˜",
            status: "å¯ç”¨",
            avatar: "/placeholder-i3oqg.png",
          },
        ],
        categories: [],
        fieldCategories: [], // åˆ†å±‚ç®¡ç†ä¸éœ€è¦å­—æ®µåˆ†ç±»
      },

      // åˆ†å±‚ç®¡ç†
      {
        id: uid(),
        name: "ç”¨æˆ·åˆ†å±‚",
        type: "table",
        supportsCategory: false,
        fields: [
          f("level", "ç­‰çº§åç§°", "text", true, true, { unique: true }),
          f("minPoints", "æœ€ä½ç§¯åˆ†", "number", true, true, { min: 0, step: 1 }),
          f("maxPoints", "æœ€é«˜ç§¯åˆ†", "number", false, true, { min: 0, step: 1 }),
          f("color", "ç­‰çº§é¢œè‰²", "text", false, true, { placeholder: "#FF6B6B" }),
          f("icon", "ç­‰çº§å›¾æ ‡", "text", false, true, { placeholder: "ğŸ¥‰" }),
          f("benefits", "ç­‰çº§æƒç›Š", "tags", false, true),
          f("description", "ç­‰çº§æè¿°", "textarea", false, true),
          f("status", "çŠ¶æ€", "select", true, true, { options: ["å¯ç”¨", "ç¦ç”¨"], default: "å¯ç”¨" }),
        ],
        records: [
          {
            id: uid(),
            level: "é’é“œ",
            minPoints: 0,
            maxPoints: 999,
            color: "#CD7F32",
            icon: "ğŸ¥‰",
            benefits: ["åŸºç¡€åŠŸèƒ½", "å®¢æœæ”¯æŒ"],
            description: "æ–°ç”¨æˆ·ç­‰çº§ï¼Œäº«å—åŸºç¡€æœåŠ¡",
            status: "å¯ç”¨",
          },
          {
            id: uid(),
            level: "ç™½é“¶",
            minPoints: 1000,
            maxPoints: 2999,
            color: "#C0C0C0",
            icon: "ğŸ¥ˆ",
            benefits: ["åŸºç¡€åŠŸèƒ½", "å®¢æœæ”¯æŒ", "ä¼˜å…ˆå¤„ç†"],
            description: "æ´»è·ƒç”¨æˆ·ç­‰çº§ï¼Œäº«å—ä¼˜å…ˆæœåŠ¡",
            status: "å¯ç”¨",
          },
          {
            id: uid(),
            level: "é»„é‡‘",
            minPoints: 3000,
            maxPoints: 9999,
            color: "#FFD700",
            icon: "ğŸ¥‡",
            benefits: ["åŸºç¡€åŠŸèƒ½", "å®¢æœæ”¯æŒ", "ä¼˜å…ˆå¤„ç†", "ä¸“å±å®¢æœ"],
            description: "é«˜çº§ç”¨æˆ·ç­‰çº§ï¼Œäº«å—ä¸“å±æœåŠ¡",
            status: "å¯ç”¨",
          },
          {
            id: uid(),
            level: "é“‚é‡‘",
            minPoints: 10000,
            maxPoints: 29999,
            color: "#E5E4E2",
            icon: "ğŸ’",
            benefits: ["åŸºç¡€åŠŸèƒ½", "å®¢æœæ”¯æŒ", "ä¼˜å…ˆå¤„ç†", "ä¸“å±å®¢æœ", "å®šåˆ¶æœåŠ¡"],
            description: "VIPç”¨æˆ·ç­‰çº§ï¼Œäº«å—å®šåˆ¶æœåŠ¡",
            status: "å¯ç”¨",
          },
          {
            id: uid(),
            level: "é’»çŸ³",
            minPoints: 30000,
            maxPoints: null,
            color: "#B9F2FF",
            icon: "ğŸ‘‘",
            benefits: ["åŸºç¡€åŠŸèƒ½", "å®¢æœæ”¯æŒ", "ä¼˜å…ˆå¤„ç†", "ä¸“å±å®¢æœ", "å®šåˆ¶æœåŠ¡", "ä¸“å±é¡¾é—®"],
            description: "è‡³å°Šç”¨æˆ·ç­‰çº§ï¼Œäº«å—ä¸“å±é¡¾é—®æœåŠ¡",
            status: "å¯ç”¨",
          },
        ],
        categories: [],
      },

      // ä¼šå‘˜ç®¡ç†
      {
        id: uid(),
        name: "ä¼šå‘˜ç±»å‹",
        type: "table",
        supportsCategory: false,
        fields: [
          f("name", "ä¼šå‘˜åç§°", "text", true, true, { unique: true }),
          f("price", "ä¼šå‘˜ä»·æ ¼", "number", true, true, { min: 0, step: 0.01, unit: "Â¥" }),
          f("duration", "æœ‰æ•ˆæœŸ", "number", true, true, { min: 1, step: 1, unit: "å¤©" }),
          f("features", "ä¼šå‘˜ç‰¹æƒ", "tags", false, true),
          f("discount", "æŠ˜æ‰£æ¯”ä¾‹", "percent", false, true, { min: 0, max: 100, default: 100 }),
          f("maxUsers", "æœ€å¤§ç”¨æˆ·æ•°", "number", false, true, { min: 1, step: 1 }),
          f("description", "ä¼šå‘˜æè¿°", "textarea", false, true),
          f("popular", "æ¨èæ ‡è¯†", "boolean", false, true, { default: false, trueLabel: "æ˜¯", falseLabel: "å¦" }),
          f("status", "çŠ¶æ€", "select", true, true, { options: ["å¯ç”¨", "ç¦ç”¨"], default: "å¯ç”¨" }),
        ],
        records: [
          {
            id: uid(),
            name: "æ™®é€šç”¨æˆ·",
            price: 0,
            duration: 365,
            features: ["åŸºç¡€åŠŸèƒ½", "æ ‡å‡†å®¢æœ"],
            discount: 100,
            maxUsers: null,
            description: "å…è´¹ç”¨æˆ·ï¼Œäº«å—åŸºç¡€åŠŸèƒ½",
            popular: false,
            status: "å¯ç”¨",
          },
          {
            id: uid(),
            name: "VIPä¼šå‘˜",
            price: 99,
            duration: 30,
            features: ["åŸºç¡€åŠŸèƒ½", "æ ‡å‡†å®¢æœ", "å»å¹¿å‘Š", "ä¼˜å…ˆæ”¯æŒ"],
            discount: 95,
            maxUsers: null,
            description: "æœˆåº¦VIPä¼šå‘˜ï¼Œäº«å—ä¼˜è´¨æœåŠ¡",
            popular: true,
            status: "å¯ç”¨",
          },
          {
            id: uid(),
            name: "SVIPä¼šå‘˜",
            price: 299,
            duration: 90,
            features: ["åŸºç¡€åŠŸèƒ½", "æ ‡å‡†å®¢æœ", "å»å¹¿å‘Š", "ä¼˜å…ˆæ”¯æŒ", "ä¸“å±å®¢æœ", "é«˜çº§åŠŸèƒ½"],
            discount: 90,
            maxUsers: null,
            description: "å­£åº¦SVIPä¼šå‘˜ï¼Œäº«å—ä¸“å±æœåŠ¡",
            popular: false,
            status: "å¯ç”¨",
          },
          {
            id: uid(),
            name: "ä¼ä¸šä¼šå‘˜",
            price: 999,
            duration: 365,
            features: ["åŸºç¡€åŠŸèƒ½", "æ ‡å‡†å®¢æœ", "å»å¹¿å‘Š", "ä¼˜å…ˆæ”¯æŒ", "ä¸“å±å®¢æœ", "é«˜çº§åŠŸèƒ½", "å›¢é˜Ÿç®¡ç†", "æ•°æ®åˆ†æ"],
            discount: 85,
            maxUsers: 100,
            description: "å¹´åº¦ä¼ä¸šä¼šå‘˜ï¼Œé€‚åˆå›¢é˜Ÿä½¿ç”¨",
            popular: false,
            status: "å¯ç”¨",
          },
        ],
        categories: [],
        fieldCategories: [], // ä¼šå‘˜ç±»å‹ä¸éœ€è¦å­—æ®µåˆ†ç±»
      },

      // ç§¯åˆ†ç®¡ç†
      {
        id: uid(),
        name: "ç§¯åˆ†è§„åˆ™",
        type: "table",
        supportsCategory: true,
        fields: [
          f("name", "è§„åˆ™åç§°", "text", true, true, { unique: true }),
          f("action", "è§¦å‘åŠ¨ä½œ", "select", true, true, {
            options: ["æ³¨å†Œ", "ç™»å½•", "ç­¾åˆ°", "åˆ†äº«", "é‚€è¯·", "æ¶ˆè´¹", "è¯„ä»·", "å®Œå–„èµ„æ–™"],
          }),
          f("points", "ç§¯åˆ†æ•°é‡", "number", true, true, { step: 1 }),
          f("maxDaily", "æ¯æ—¥ä¸Šé™", "number", false, true, { min: 0, step: 1 }),
          f("maxTotal", "æ€»è®¡ä¸Šé™", "number", false, true, { min: 0, step: 1 }),
          f("description", "è§„åˆ™æè¿°", "textarea", false, true),
          f("startDate", "å¼€å§‹æ—¶é—´", "date", false, true, { dateMode: "single" }),
          f("endDate", "ç»“æŸæ—¶é—´", "date", false, true, { dateMode: "single" }),
          f("status", "çŠ¶æ€", "select", true, true, { options: ["å¯ç”¨", "ç¦ç”¨"], default: "å¯ç”¨" }),
        ],
        records: [
          {
            id: uid(),
            name: "æ–°ç”¨æˆ·æ³¨å†Œ",
            action: "æ³¨å†Œ",
            points: 100,
            maxDaily: null,
            maxTotal: 100,
            description: "æ–°ç”¨æˆ·æ³¨å†Œå¥–åŠ±ç§¯åˆ†",
            startDate: null,
            endDate: null,
            status: "å¯ç”¨",
          },
          {
            id: uid(),
            name: "æ¯æ—¥ç­¾åˆ°",
            action: "ç­¾åˆ°",
            points: 10,
            maxDaily: 10,
            maxTotal: null,
            description: "æ¯æ—¥ç­¾åˆ°è·å¾—ç§¯åˆ†",
            startDate: null,
            endDate: null,
            status: "å¯ç”¨",
          },
          {
            id: uid(),
            name: "é‚€è¯·å¥½å‹",
            action: "é‚€è¯·",
            points: 50,
            maxDaily: 200,
            maxTotal: null,
            description: "æˆåŠŸé‚€è¯·å¥½å‹æ³¨å†Œè·å¾—ç§¯åˆ†",
            startDate: null,
            endDate: null,
            status: "å¯ç”¨",
          },
          {
            id: uid(),
            name: "å®Œå–„èµ„æ–™",
            action: "å®Œå–„èµ„æ–™",
            points: 20,
            maxDaily: null,
            maxTotal: 20,
            description: "å®Œå–„ä¸ªäººèµ„æ–™è·å¾—ç§¯åˆ†",
            startDate: null,
            endDate: null,
            status: "å¯ç”¨",
          },
        ],
        categories: [
          {
            id: uid(),
            name: "åŸºç¡€è§„åˆ™",
            children: [],
          },
          {
            id: uid(),
            name: "æ´»åŠ¨è§„åˆ™",
            children: [],
          },
        ],
        fieldCategories: [], // ç§¯åˆ†è§„åˆ™ä¸éœ€è¦å­—æ®µåˆ†ç±»
      },
    ],
  }
}
