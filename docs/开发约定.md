# AINO 项目开发约定

## 🚨 重要提醒
**严禁随意修改以下配置信息！** 所有配置变更必须经过讨论和测试。

## 数据库配置约定

### PostgreSQL 配置
- **主机**: localhost
- **端口**: 5432 (默认端口)
- **数据库名**: aino
- **用户名**: devin
- **密码**: (空密码，使用系统认证)
- **SSL**: 禁用

### 环境变量配置
```env
DB_HOST=localhost
DB_PORT=5432
DB_USER=devin
DB_PASSWORD=
DB_NAME=aino
```

## 服务端口约定

### 开发环境端口
- **前端应用**: 3000
- **后端 API**: 3001
- **Drizzle Studio**: https://local.drizzle.studio

## 启动脚本约定

### 标准启动命令
```bash
./start-fixed.sh  # 启动所有服务
```

### Drizzle Studio 特殊启动
由于 Drizzle Studio 对空密码的处理问题，需要使用以下命令：
```bash
cd AINO-server && DB_PASSWORD="dummy" pnpm studio
```

## 文件结构约定

### 配置文件位置
- 环境变量: `AINO-server/src/env.ts`
- 数据库配置: `AINO-server/drizzle.config.ts`
- 启动脚本: `start-fixed.sh`

### 日志文件位置
- 后端日志: `logs/backend.log`
- 前端日志: `logs/frontend.log`
- Drizzle日志: `logs/drizzle.log`

## 开发原则

### 1. 配置稳定性
- 不要随意修改数据库连接信息
- 不要随意更改端口配置
- 不要随意修改用户权限

### 2. 向后兼容
- 所有配置变更必须保持向后兼容
- 新增配置必须有合理的默认值
- 删除配置前必须确认无依赖

### 3. 文档更新
- 任何配置变更必须同步更新此文档
- 变更原因和影响必须记录
- 测试结果必须验证

## 故障排除

### 常见问题
1. **Drizzle Studio 启动失败**: 使用 `DB_PASSWORD="dummy"` 启动
2. **数据库连接失败**: 检查 PostgreSQL 服务状态
3. **端口冲突**: 检查端口占用情况

### 恢复步骤
1. 检查此文档中的标准配置
2. 对比当前配置与标准配置
3. 如有差异，恢复到标准配置
4. 重启相关服务

## 变更记录

### 2024-08-26
- 建立开发约定文档
- 明确数据库配置标准
- 记录 Drizzle Studio 特殊启动方式

---

**记住：配置的稳定性比功能的完美更重要！**
